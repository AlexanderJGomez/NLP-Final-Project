The visitors had dominated the game and created a series of chances, but  looked set for another goalless draw until di Maria struck with nine minutes left.
Former Ajax striker Zlatan Ibrahimovic dealt his old side a blow with Milan's equalizer -- his third in the tournament having scored twice in the opening 2-0 win over Auxerre.
Partizan Marko Jovanovic lost early in the second-half as he conceded a penalty but Arshavin saw his penalty saved by goalkeeper Vladimir Stojkovic before striker Marouane Chamakh put them ahead again on 71 minutes.
Costa set up his teammate and compatriot for the first two goals and added the third from the spot in the last minute when converted after Paulo Cesar had fouled Willian in the area.