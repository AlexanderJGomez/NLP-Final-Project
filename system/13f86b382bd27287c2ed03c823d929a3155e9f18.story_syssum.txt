The Swiss looked to be running away with the second after opening up a 3-0 lead, but the world No.
The Ukrainian, who shocked Rafael Nadal in the third round at Indian Wells, edged through in a tiebreak after rain halted play for an hour with the score poised at 5-5 in the final set.
In the women's draw, Serena Williams is safely through the quarterfinals after defeating compatriot Coco Vandeweghe 6-3 6-1.
"CoCo has such an amazing serve, so every time I was returning I was like, 'Hopefully I can touch the ball.'
The Russian fourth seed lost the opening set, serving five double faults, before battling back strongly to win 3-6 6-4 6-1 and book a place in the quarterfinals.
"Of course you want to be able to hold the winner's trophy, but you also know the matches you've got to get through to get to the final stage," Sharapova said.