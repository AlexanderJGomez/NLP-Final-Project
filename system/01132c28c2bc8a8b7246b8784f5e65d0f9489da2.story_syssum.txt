It was truly the great escape for 12th seed Monfils, who was on the ropes as he served at 5-6 down in the deciding set, having broken back after dropping his service for the first time.
Federer retrieved the loss but uncharacteristic forehand errors saw him fall behind again and when Monfils was presented with his first match point he seized it.
Earlier, world number five Robin Soderling had to save three match points before ending the fairytale run of Llodra.
It wasn't maybe pretty, but I'm here as a winner," Soderling told the official ATP Tour website.