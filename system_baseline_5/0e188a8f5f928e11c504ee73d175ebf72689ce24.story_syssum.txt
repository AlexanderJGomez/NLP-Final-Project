Allen informed Obama that he will leave the service rather than move forward with the nomination, which requires Senate confirmation, a White House statement said.
Allen, a Marine Corps general, was the top coalition commander in Afghanistan for nearly two years.
CNN previously reported that Defense Department officials said there was inappropriate language in those e-mails, but no evidence of an affair between Allen and Kelley.
Allen "presided over the significant growth in the size and capability of Afghan National Security Forces, the further degradation of al Qaeda and their extremist allies, and the ongoing transition to Afghan security responsibility across the country," Obama said in the statement.
Allen later faced additional diplomatic crises that followed controversial incidents that included the accidental burning of Qurans by U.S. service members, U.S. airstrikes that resulted in civilian deaths and the killing of 16 civilians in a massacre allegedly carried out by a U.S. service member.
An uptick in "green-on-blue" attacks -- in which Afghan forces or trainees turn their weapons against U.S. counterparts -- is also believed to have hampered the training of Afghan forces and contributed to increased public discontent at home over American deployment to the region.