The Canadian announcement has puzzled some terrorism experts, because Iranian authorities are widely seen as hostile to al Qaeda.
Canadian officials say they did not think the alleged conspirators were "state-sponsored" but suspect al Qaeda elements in Iran had provided two men in Canada with direction, guidance and information.
Al Qaeda leader Ayman al Zawahiri has often railed against Iran in his speeches.
Another aspect of the alleged Canadian plot is that it underlines the enduring interest of al Qaeda and its supporters in attacking railroad systems, seeing such operations as relatively cheap and easy to carry out -- with potentially devastating results.
Documents recovered from his compound in Abbottabad in Pakistan revealed that early in 2010, al Qaeda had discussed an idea to derail a train in the United States, several U.S. officials told CNN.
In March 2008, American al Qaeda recruit Bryant Neal Vinas discussed a plan to attack the Long Island Railroad with al Qaeda operatives in a jihadist encampment in the tribal areas of Pakistan.
There is little evidence to link "al Qaeda central" with the Madrid attack, which involved a cell of mainly Moroccan immigrants.
The explosives were similar to those used in the Madrid attacks.
On July 7, 2005, al Qaeda suicide bombers killed dozens on the London underground system.