Canadian officials say they did not think the alleged conspirators were "state-sponsored" but suspect al Qaeda elements in Iran had provided two men in Canada with direction, guidance and information.
But Iran has become increasingly hostile to al Qaeda as it has become a Sunni sectarian group, especially in Iraq and Syria, as much as an anti-western outfit.
Al Qaeda leader Ayman al Zawahiri has often railed against Iran in his speeches.
Documents recovered from his compound in Abbottabad in Pakistan revealed that early in 2010, al Qaeda had discussed an idea to derail a train in the United States, several U.S. officials told CNN.
In March 2008, American al Qaeda recruit Bryant Neal Vinas discussed a plan to attack the Long Island Railroad with al Qaeda operatives in a jihadist encampment in the tribal areas of Pakistan.
There is little evidence to link "al Qaeda central" with the Madrid attack, which involved a cell of mainly Moroccan immigrants.
On July 7, 2005, al Qaeda suicide bombers killed dozens on the London underground system.
In December 2012, German police discovered a crude improvised explosive device placed in a bag on a platform at the main railway station in Bonn.