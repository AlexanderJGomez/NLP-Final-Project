Canadian officials say they did not think the alleged conspirators were "state-sponsored" but suspect al Qaeda elements in Iran had provided two men in Canada with direction, guidance and information.
Many al Qaeda sympathizers and members took refuge in Iran in the aftermath of the post 9/11 invasion of Afghanistan, including one son of Osama bin Laden, Saad bin Laden, and a son-in-law, Sulaiman Abu Ghaith.
Al Qaeda leader Ayman al Zawahiri has often railed against Iran in his speeches.
Documents recovered from his compound in Abbottabad in Pakistan revealed that early in 2010, al Qaeda had discussed an idea to derail a train in the United States, several U.S. officials told CNN.
In March 2008, American al Qaeda recruit Bryant Neal Vinas discussed a plan to attack the Long Island Railroad with al Qaeda operatives in a jihadist encampment in the tribal areas of Pakistan.
There is little evidence to link "al Qaeda central" with the Madrid attack, which involved a cell of mainly Moroccan immigrants.
The explosives were similar to those used in the Madrid attacks.
In December 2012, German police discovered a crude improvised explosive device placed in a bag on a platform at the main railway station in Bonn.